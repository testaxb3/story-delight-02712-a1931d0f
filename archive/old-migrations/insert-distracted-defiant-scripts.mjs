import { createClient } from '@supabase/supabase-js';

const SUPABASE_URL = 'https://iogceaotdodvugrmogpp.supabase.co';
const SERVICE_ROLE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlvZ2NlYW90ZG9kdnVncm1vZ3BwIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2MDg4NzA4NCwiZXhwIjoyMDc2NDYzMDg0fQ.UBWhZUiQY0CklVKJonHbnjQRX51PvBaQDKy6-66Q-jU';

const supabase = createClient(SUPABASE_URL, SERVICE_ROLE_KEY);

const distractedScripts = [
  {
    title: 'Morning Launch Sequence',
    category: 'Morning_Routines',
    wrong_way: '"Hurry up! We\'re going to be late AGAIN! Why can\'t you just get ready?!"',
    phrase_1: 'Morning brain needs help starting...',
    phrase_1_action: 'Stand in front of them. Make eye contact. Use their name.',
    phrase_2: 'Hard to remember steps when brain is sleepy, AND we can make it easy...',
    phrase_2_action: 'Hold up visual checklist. Point to first item.',
    phrase_3: 'Clothes or breakfast first. Pick one, let\'s race the timer.',
    phrase_3_action: 'Set 2-minute timer. Stay with them. High-five when they start.',
    neurological_tip: 'DISTRACTED brains need external cues to initiate tasks. Morning cortisol is high, making focus harder. Visual checklist + timer = external structure their prefrontal cortex can\'t generate yet. Racing the timer releases dopamine.',
    profile: 'DISTRACTED',
    tags: ['morning', 'routine', 'executive function', 'adhd', 'getting ready'],
    situation_trigger: 'When child is frozen/spacing out during morning routine and you\'re running late',
    location_type: ['home', 'bedroom'],
    time_optimal: ['morning'],
    intensity_level: 'moderate',
    success_speed: '2min',
    parent_state: ['rushed', 'frustrated', 'anxious'],
    age_min: 4,
    age_max: 12,
    backup_plan: 'Do first step WITH them physically (hand them clothes, walk to kitchen together). Momentum from one completed step often triggers the next.',
    common_mistakes: ['Yelling from another room (they genuinely didn\'t process it)', 'Giving multi-step instructions all at once (working memory can\'t hold it)', 'Assuming they\'re being defiant (they\'re frozen, not refusing)', 'Removing screen time as consequence (doesn\'t address the executive dysfunction)'],
    pause_after_phrase_1: 3,
    pause_after_phrase_2: 2,
    expected_time_seconds: 120,
    requires_preparation: true,
    works_in_public: false,
    emergency_suitable: true
  },
  {
    title: 'Screen Shutdown Sprint',
    category: 'Screens',
    wrong_way: '"I SAID turn it off NOW! Hand me the tablet right this second!"',
    phrase_1: 'Tablet time is ending soon...',
    phrase_1_action: '5-minute warning. Show them the timer countdown visually.',
    phrase_2: 'Brain loves tablet dopamine, AND our deal is 20 minutes...',
    phrase_2_action: '2-minute warning. Stay visible. Keep voice calm and neutral.',
    phrase_3: 'Save your game or I turn it off. Counting to 10.',
    phrase_3_action: 'Count slowly. If they save: praise. If not: calmly power off at 10.',
    neurological_tip: 'Screens flood DISTRACTED brains with dopamine they can\'t generate internally. Abrupt stop = withdrawal response. Progressive warnings + countdown = external regulation support. "Save your game" = gives control, reduces amygdala spike.',
    profile: 'DISTRACTED',
    tags: ['screen time', 'tablet', 'video games', 'transitions', 'dopamine', 'adhd'],
    situation_trigger: 'When child is hyperfocused on screen and won\'t stop when time is up',
    location_type: ['home', 'car', 'anytime'],
    time_optimal: ['anytime'],
    intensity_level: 'moderate',
    success_speed: '30sec',
    parent_state: ['frustrated', 'rushed', 'exhausted'],
    age_min: 4,
    age_max: 14,
    backup_plan: 'Power off device. Hand them a fidget toy immediately. Say: "I know that felt bad. Here\'s something for your hands." Redirect to high-movement activity.',
    common_mistakes: ['No warning (their brain needs transition time)', 'Arguing about fairness mid-shutdown (logic doesn\'t work when dopamine drops)', 'Removing screens as punishment tomorrow (doesn\'t help today\'s transition)', 'Getting angry at their upset (it\'s neurological withdrawal)'],
    pause_after_phrase_1: 2,
    pause_after_phrase_2: 2,
    expected_time_seconds: 30,
    requires_preparation: false,
    works_in_public: true,
    emergency_suitable: true
  },
  {
    title: 'Assignment Ignition',
    category: 'Homework',
    wrong_way: '"You\'ve been staring at that blank page for 20 minutes! Just START!"',
    phrase_1: 'Brain is stuck at the starting line...',
    phrase_1_action: 'Sit next to them. Close extra books. Clear visual clutter.',
    phrase_2: 'Hard when task feels huge and brain freezes, AND we can shrink it...',
    phrase_2_action: 'Cover all except first problem with paper. Make it tiny.',
    phrase_3: 'Just the first sentence. Write one word with me.',
    phrase_3_action: 'Write first word together. Celebrate. Then they write next word.',
    neurological_tip: 'Task initiation paralysis is DISTRACTED brains\' biggest challenge - it\'s not laziness. Working memory can\'t hold the whole task, causing freeze. Physical start with you = external activation energy their brain needs.',
    profile: 'DISTRACTED',
    tags: ['homework', 'writing', 'executive function', 'task initiation', 'paralysis', 'adhd'],
    situation_trigger: 'When child is staring at blank homework page unable to start writing',
    location_type: ['home', 'school'],
    time_optimal: ['afternoon', 'evening'],
    intensity_level: 'moderate',
    success_speed: '1min',
    parent_state: ['frustrated', 'losing patience', 'confused why they won\'t start'],
    age_min: 6,
    age_max: 16,
    backup_plan: 'You write first sentence as they dictate. Then they write second sentence. Scaffolding = external support until momentum builds. Not "doing it for them" - it\'s accommodating disability.',
    common_mistakes: ['Saying "just start anywhere" (too vague for ADHD brain)', 'Leaving them alone to "figure it out" (they need co-regulation)', 'Removing privileges until they start (adds pressure to paralysis)', 'Thinking they\'re manipulating (genuine neurological block)'],
    pause_after_phrase_1: 3,
    pause_after_phrase_2: 2,
    expected_time_seconds: 60,
    requires_preparation: true,
    works_in_public: false,
    emergency_suitable: false
  },
  {
    title: 'Dress-Up Speed Run',
    category: 'Morning_Routines',
    wrong_way: '"Where are your pants?! You were supposed to be getting dressed 10 minutes ago!"',
    phrase_1: 'Body got distracted mid-dressing...',
    phrase_1_action: 'Stand at door. Don\'t lecture. State what you see neutrally.',
    phrase_2: 'Brain wandered while body was changing, AND clothes are right here...',
    phrase_2_action: 'Hold up pants. Point to each item needed.',
    phrase_3: 'Pants on before I count to 20. Ready, set, go.',
    phrase_3_action: 'Count out loud. Cheer at 10. They usually finish before 20.',
    neurological_tip: 'DISTRACTED kids genuinely forget mid-task - working memory drops the ball. They need external prompts every 30 seconds. Counting = constant external cue + gamification = dopamine boost.',
    profile: 'DISTRACTED',
    tags: ['getting dressed', 'morning', 'distraction', 'working memory', 'executive function'],
    situation_trigger: 'When you find child half-dressed and playing instead of finishing getting dressed',
    location_type: ['home', 'bedroom'],
    time_optimal: ['morning', 'anytime'],
    intensity_level: 'mild',
    success_speed: '1min',
    parent_state: ['rushed', 'frustrated', 'running late'],
    age_min: 3,
    age_max: 10,
    backup_plan: 'Dress them yourself calmly. Say: "Brain needed help today. Tomorrow we\'ll try the race again." No shame, just support.',
    common_mistakes: ['Asking "why aren\'t you dressed" (they don\'t know - they forgot)', 'Getting angry (wasn\'t intentional)', 'Expecting them to remember after one reminder (working memory deficit)', 'Leaving them alone to finish (they need ongoing cues)'],
    pause_after_phrase_1: 2,
    pause_after_phrase_2: 2,
    expected_time_seconds: 60,
    requires_preparation: false,
    works_in_public: false,
    emergency_suitable: true
  },
  {
    title: 'Launch Pad Lockdown',
    category: 'Transitions',
    wrong_way: '"Where\'s your backpack?! Your homework?! We\'re LEAVING! Why do you never remember anything?!"',
    phrase_1: 'Leaving time, brain check needed...',
    phrase_1_action: 'Stop them at door. Calm voice. Make eye contact.',
    phrase_2: 'Hard to remember everything when rushing, AND we have a system...',
    phrase_2_action: 'Point to launch pad checklist on wall/door.',
    phrase_3: 'Touch each thing as you check. Backpack, lunch, shoes. Go.',
    phrase_3_action: 'Stay with them. They touch each item. You confirm. Then leave together.',
    neurological_tip: 'DISTRACTED brains have poor working memory - they can\'t mentally track multiple items. External checklist at transition point = prosthetic memory. Physical touch = adds sensory memory channel.',
    profile: 'DISTRACTED',
    tags: ['leaving', 'forgetting things', 'working memory', 'executive function', 'transitions', 'school'],
    situation_trigger: 'When rushing to leave and child forgot backpack/lunch/shoes again',
    location_type: ['home', 'door', 'car'],
    time_optimal: ['morning', 'afternoon'],
    intensity_level: 'mild',
    success_speed: '30sec',
    parent_state: ['rushed', 'anxious', 'frustrated'],
    age_min: 5,
    age_max: 14,
    backup_plan: 'Stop. Take 30 seconds to gather items yourself. Say: "I\'ll help today. Tomorrow we practice the checklist before we\'re rushed." Build the habit first.',
    common_mistakes: ['Blaming them for forgetting (it\'s neurological)', 'Expecting memory to improve without support system (it won\'t)', 'Punishing forgotten items (doesn\'t build working memory)', 'Rushing through door anyway (teaches: forgetting is normal)'],
    pause_after_phrase_1: 2,
    pause_after_phrase_2: 2,
    expected_time_seconds: 30,
    requires_preparation: true,
    works_in_public: false,
    emergency_suitable: true
  },
  {
    title: 'Dinner Table Mission',
    category: 'Mealtime',
    wrong_way: '"SIT STILL! Stop fidgeting! Just eat your food!"',
    phrase_1: 'Body needs to move at dinner...',
    phrase_1_action: 'Acknowledge movement need without criticism.',
    phrase_2: 'Hard to sit totally still when body has energy, AND we need eating time...',
    phrase_2_action: 'Offer fidget under table or wobble cushion.',
    phrase_3: 'Stand and eat or sit with fidget. Pick what helps.',
    phrase_3_action: 'Let them stand if needed. Movement = eating. Perfect.',
    neurological_tip: 'DISTRACTED kids have high motor activity needs - sitting still uses cognitive resources needed for eating. Movement = better focus. Fidgets + permission to stand = removes sitting battle, allows eating.',
    profile: 'DISTRACTED',
    tags: ['mealtime', 'fidgeting', 'sitting still', 'adhd', 'movement', 'sensory needs'],
    situation_trigger: 'When child won\'t stop fidgeting/moving during mealtime and barely eating',
    location_type: ['home', 'restaurant'],
    time_optimal: ['afternoon', 'evening'],
    intensity_level: 'mild',
    success_speed: '2min',
    parent_state: ['frustrated', 'exhausted', 'embarrassed'],
    age_min: 3,
    age_max: 12,
    backup_plan: 'Say: "Eat while you walk around the kitchen. Bring me bites to show me." Remove sit-still expectation completely. Nutrition > manners today.',
    common_mistakes: ['Forcing rigid sitting (uses all their self-regulation)', 'Comparing to siblings who can sit (different brains)', 'Punishment for fidgeting (it\'s involuntary)', 'Making mealtime a battle (creates food anxiety)'],
    pause_after_phrase_1: 2,
    pause_after_phrase_2: 2,
    expected_time_seconds: 120,
    requires_preparation: true,
    works_in_public: false,
    emergency_suitable: false
  },
  {
    title: 'Night Mode Activation',
    category: 'Bedtime',
    wrong_way: '"It\'s bedtime! Stop running around! Calm down RIGHT NOW!"',
    phrase_1: 'Body is still in go mode...',
    phrase_1_action: 'State the observation. Don\'t demand stopping.',
    phrase_2: 'Hard when brain hasn\'t made sleepy chemicals yet, AND we can help it...',
    phrase_2_action: 'Dim lights. Lower your voice. Move slower yourself.',
    phrase_3: 'Heavy work first, then PJs. Push the wall or pillow squeezes.',
    phrase_3_action: 'Have them push against wall for 10 reps. Then guide to PJs.',
    neurological_tip: 'DISTRACTED kids\' circadian rhythm is often delayed + high arousal system. Heavy proprioceptive input (pushing, squeezing) increases dopamine + activates parasympathetic nervous system = natural calm.',
    profile: 'DISTRACTED',
    tags: ['bedtime', 'hyperactivity', 'wind down', 'proprioceptive input', 'sensory regulation', 'adhd'],
    situation_trigger: 'When child is running around hyper at bedtime instead of calming down',
    location_type: ['home'],
    time_optimal: ['evening'],
    intensity_level: 'moderate',
    success_speed: '5min',
    parent_state: ['exhausted', 'frustrated', 'desperate for them to sleep'],
    age_min: 3,
    age_max: 12,
    backup_plan: 'Abandon bedtime routine. Do 20 jumping jacks together. Then bath or shower (water = heavy input). Then try bed again. Movement before stillness.',
    common_mistakes: ['Demanding instant calm (physiologically impossible)', 'Threatening consequences (increases arousal)', 'Thinking they\'re misbehaving (it\'s neurological hyperarousal)', 'Skipping the heavy work (that\'s what their body needs)'],
    pause_after_phrase_1: 3,
    pause_after_phrase_2: 2,
    expected_time_seconds: 300,
    requires_preparation: false,
    works_in_public: false,
    emergency_suitable: false
  },
  {
    title: 'Cleanup Speed Challenge',
    category: 'Problem_Solving',
    wrong_way: '"Clean up this mess RIGHT NOW! I\'m not asking again!"',
    phrase_1: 'Brain sees big mess, feels overwhelmed...',
    phrase_1_action: 'Stand in room with them. Point to small area.',
    phrase_2: 'Hard to know where to start when it\'s so much, AND we can make it tiny...',
    phrase_2_action: 'Hand them one basket. Point to just the Legos.',
    phrase_3: 'Just Legos in basket. Race me, I\'ll do books. Ready, set, go.',
    phrase_3_action: 'Do your task loudly. Cheer when they finish. Do next tiny task together.',
    neurological_tip: 'DISTRACTED kids have initiation paralysis with large tasks - executive function can\'t break it down. You do the breakdown FOR them. Gamification + movement + immediate completion = dopamine hits.',
    profile: 'DISTRACTED',
    tags: ['cleanup', 'messy room', 'executive function', 'task initiation', 'overwhelm', 'adhd'],
    situation_trigger: 'When child is frozen/avoiding cleaning room because mess feels too big',
    location_type: ['home', 'bedroom', 'playroom'],
    time_optimal: ['afternoon', 'anytime'],
    intensity_level: 'moderate',
    success_speed: '2min',
    parent_state: ['frustrated', 'exhausted', 'angry'],
    age_min: 4,
    age_max: 14,
    backup_plan: 'Say: "I\'ll help today. You do this pile, I do that pile." Do it together. Building the skill > independence right now. Shame-free help = future success.',
    common_mistakes: ['Leaving them alone to do it (they\'ll freeze again)', 'Saying "you made the mess, you clean it" (they need support)', 'No breakdown of steps (too abstract)', 'Punishment for not finishing (adds pressure to paralysis)'],
    pause_after_phrase_1: 3,
    pause_after_phrase_2: 2,
    expected_time_seconds: 120,
    requires_preparation: false,
    works_in_public: false,
    emergency_suitable: false
  },
  {
    title: 'Seatbelt Safety Lock',
    category: 'Transitions',
    wrong_way: '"BUCKLE UP NOW! We are NOT going anywhere until you click that seatbelt!"',
    phrase_1: 'Body wants to jump out...',
    phrase_1_action: 'Turn around from front seat. Calm face. No yelling.',
    phrase_2: 'Hard to wait when body is excited, AND seatbelts keep you safe...',
    phrase_2_action: 'Hold eye contact. Count down from 5 slowly.',
    phrase_3: 'Buckled by zero or car doesn\'t move. You choose. 5... 4...',
    phrase_3_action: 'Count slowly. If buckled: immediate praise + drive. If not: wait at zero calmly.',
    neurological_tip: 'DISTRACTED kids have poor impulse control + delayed consequences don\'t compute. Immediate consequence (car not moving) + countdown = external impulse control. Zero delay between choice and consequence.',
    profile: 'DISTRACTED',
    tags: ['car seat', 'safety', 'impulse control', 'transitions', 'adhd', 'cooperation'],
    situation_trigger: 'When child unbuckles seatbelt or won\'t buckle and you\'re trying to drive',
    location_type: ['car'],
    time_optimal: ['anytime'],
    intensity_level: 'severe',
    success_speed: '30sec',
    parent_state: ['scared for safety', 'angry', 'frustrated'],
    age_min: 3,
    age_max: 10,
    backup_plan: 'Pull over immediately if already driving. Stop car. Say: "Seatbelts keep you alive. Buckled now or we sit here." Wait. No screens, no talking. Just wait. Safety is non-negotiable.',
    common_mistakes: ['Arguing while driving (focus on road)', 'Empty threats (they don\'t believe you)', 'Explaining danger while upset (logic offline)', 'Continuing to drive unbuckled (never do this)'],
    pause_after_phrase_1: 2,
    pause_after_phrase_2: 2,
    expected_time_seconds: 30,
    requires_preparation: false,
    works_in_public: true,
    emergency_suitable: true
  },
  {
    title: 'Wait Your Turn Timer',
    category: 'Social',
    wrong_way: '"STOP interrupting! Let other people talk! You are being SO RUDE!"',
    phrase_1: 'Brain has thought bursting to come out...',
    phrase_1_action: 'Acknowledge their excitement without judgment.',
    phrase_2: 'Hard to hold thoughts when they feel so big, AND we take turns talking...',
    phrase_2_action: 'Hold up hand as visual signal. "Hold that thought."',
    phrase_3: 'Tell me after Mom finishes. Touch my arm when you\'re ready.',
    phrase_3_action: 'Let other person finish. Then turn to child: "Okay, what did you want to say?"',
    neurological_tip: 'DISTRACTED brains have poor working memory - they fear forgetting the thought, so interrupt. "Touch my arm" = external memory prompt + gives them control. You WILL hear them = reduces urgency.',
    profile: 'DISTRACTED',
    tags: ['interrupting', 'waiting turn', 'conversation', 'social skills', 'impulse control', 'adhd'],
    situation_trigger: 'When child keeps interrupting adult conversations despite reminders',
    location_type: ['home', 'public', 'anytime'],
    time_optimal: ['anytime'],
    intensity_level: 'mild',
    success_speed: '1min',
    parent_state: ['embarrassed', 'frustrated', 'tired of asking'],
    age_min: 4,
    age_max: 12,
    backup_plan: 'Give them paper and pencil. Say: "Draw what you want to tell me while I finish. Then show me." Externalizes memory + keeps them busy.',
    common_mistakes: ['Shaming them for rudeness (it\'s neurological)', 'Ignoring when they touch arm (breaks trust)', 'Expecting them to remember without system (they won\'t)', 'Comparing to siblings who don\'t interrupt (different brains)'],
    pause_after_phrase_1: 2,
    pause_after_phrase_2: 2,
    expected_time_seconds: 60,
    requires_preparation: true,
    works_in_public: true,
    emergency_suitable: false
  }
];

const defiantScripts = [
  {
    title: 'Screen Time Power Negotiation',
    category: 'Screens',
    wrong_way: '"I said screen time is OVER! Hand me the tablet NOW or you lose it for a week!"',
    phrase_1: 'You want more screen time, I get it...',
    phrase_1_action: 'Sit near them. Acknowledge desire without giving in.',
    phrase_2: 'Hard when you want more, AND our deal was 30 minutes...',
    phrase_2_action: 'Point to timer/agreement. Stay calm and neutral.',
    phrase_3: 'Turn off now, earn tomorrow. Keep arguing, lose tomorrow. You decide.',
    phrase_3_action: 'Wait. Don\'t engage in debate. If they turn off: "Good choice." If not: follow through tomorrow.',
    neurological_tip: 'DEFIANT kids need agency - orders trigger reactance. "You decide" + clear consequence = preserves autonomy while maintaining boundary. Following through tomorrow = teaches trust.',
    profile: 'DEFIANT',
    tags: ['screen time', 'power struggle', 'negotiation', 'boundaries', 'consequences', 'strong-willed'],
    situation_trigger: 'When child refuses to end screen time and starts arguing/negotiating for more',
    location_type: ['home', 'car'],
    time_optimal: ['anytime'],
    intensity_level: 'moderate',
    success_speed: '30sec',
    parent_state: ['frustrated', 'tired of fighting', 'wanting to give in'],
    age_min: 5,
    age_max: 14,
    backup_plan: 'Power off device yourself. Say calmly: "You chose not to decide. Tomorrow you can try again." Put device away. No lecture. Natural consequence.',
    common_mistakes: ['Negotiating in the moment (teaches: arguing works)', 'Giving "just 5 more minutes" (breaks trust in boundaries)', 'Threatening but not following through (loss of credibility)', 'Getting angry (escalates power struggle)'],
    pause_after_phrase_1: 3,
    pause_after_phrase_2: 2,
    expected_time_seconds: 30,
    requires_preparation: false,
    works_in_public: true,
    emergency_suitable: true
  },
  {
    title: 'The Direct "NO" Refusal',
    category: 'Emotional_Regulation',
    wrong_way: '"Don\'t you say NO to me! I am the parent! You WILL do what I say!"',
    phrase_1: 'I hear a big NO from you...',
    phrase_1_action: 'Acknowledge the NO. Don\'t fight it yet. Curious tone.',
    phrase_2: 'You don\'t want to do this AND it still needs to happen...',
    phrase_2_action: 'State reality. Not threatening - just factual. Wait.',
    phrase_3: 'Now or in 2 minutes. Or I choose for you. Clock starts now.',
    phrase_3_action: 'Set timer visibly. Walk away. Let them decide. No hovering.',
    neurological_tip: 'DEFIANT kids\' "NO" is self-advocacy - controlling environment feels unsafe to them. Acknowledging NO = respects autonomy. Offering when = preserves power. Timer = removes you from the power struggle.',
    profile: 'DEFIANT',
    tags: ['saying no', 'refusal', 'defiance', 'power struggle', 'strong-willed', 'opposition'],
    situation_trigger: 'When child says direct "NO" to request and you feel power struggle starting',
    location_type: ['home', 'anytime'],
    time_optimal: ['anytime'],
    intensity_level: 'severe',
    success_speed: '1min',
    parent_state: ['angry', 'feeling disrespected', 'wanting to force compliance'],
    age_min: 3,
    age_max: 12,
    backup_plan: 'After timer: "Time\'s up, I\'m choosing. We\'re doing it now." Do it WITH them calmly. You lead, they follow. No anger, just firm follow-through.',
    common_mistakes: ['Fighting the NO (escalates)', 'Demanding immediate compliance (removes all autonomy)', 'Threatening extreme consequences (not enforceable)', 'Taking it personally (it\'s about control, not you)'],
    pause_after_phrase_1: 4,
    pause_after_phrase_2: 3,
    expected_time_seconds: 60,
    requires_preparation: false,
    works_in_public: false,
    emergency_suitable: false
  },
  {
    title: 'Room Cleaning Standoff',
    category: 'Problem_Solving',
    wrong_way: '"Clean your room NOW or you\'re grounded! I\'m not asking again!"',
    phrase_1: 'Room needs cleaning. You don\'t want to...',
    phrase_1_action: 'State facts. No judgment. Stand in doorway.',
    phrase_2: 'I get it, cleaning is boring, AND messy room means lost stuff...',
    phrase_2_action: 'Point out natural consequence, not punishment.',
    phrase_3: 'Clean it your way by bedtime or I clean it my way. Your stuff, your choice.',
    phrase_3_action: 'Walk away. If not done by bedtime: bag up items on floor, put in garage for a week.',
    neurological_tip: 'DEFIANT kids resist forced tasks. "Your way" = autonomy. Natural consequence (losing access to stuff) > arbitrary punishment. Following through = teaches your word is solid.',
    profile: 'DEFIANT',
    tags: ['cleaning room', 'messy', 'power struggle', 'chores', 'responsibility', 'consequences'],
    situation_trigger: 'When child refuses to clean room and you\'re tired of asking',
    location_type: ['home', 'bedroom'],
    time_optimal: ['afternoon', 'evening'],
    intensity_level: 'moderate',
    success_speed: '2min',
    parent_state: ['frustrated', 'exhausted', 'angry at the mess'],
    age_min: 6,
    age_max: 16,
    backup_plan: 'At bedtime: calmly put items in trash bag. Say: "You chose not to clean. Bag goes to garage for a week. You can earn things back." No anger, just consequence.',
    common_mistakes: ['Cleaning it yourself with no consequence (teaches: someone else will do it)', 'Extreme threats like "I\'ll throw everything away" (not enforceable)', 'Daily battles (pick: clean on weekends or natural consequences)', 'Doing it together (removes their choice/ownership)'],
    pause_after_phrase_1: 3,
    pause_after_phrase_2: 2,
    expected_time_seconds: 120,
    requires_preparation: false,
    works_in_public: false,
    emergency_suitable: false
  },
  {
    title: 'Backtalk Boundary',
    category: 'Social',
    wrong_way: '"How DARE you talk to me like that! Apologize RIGHT NOW!"',
    phrase_1: 'Those words felt disrespectful...',
    phrase_1_action: 'Name what happened. Firm but not yelling. Eye contact.',
    phrase_2: 'You\'re angry AND mean words hurt people...',
    phrase_2_action: 'Acknowledge emotion, maintain boundary.',
    phrase_3: 'Say it different or take space. I\'m listening when you\'re ready.',
    phrase_3_action: 'Wait. Give option to rephrase or cool off. Don\'t engage backtalk.',
    neurological_tip: 'DEFIANT kids backtalk to assert independence - often when feeling powerless. Forced apology = fake. "Say it different" = teaches communication while respecting their frustration. Space option = control.',
    profile: 'DEFIANT',
    tags: ['backtalk', 'disrespect', 'rude', 'talking back', 'boundaries', 'communication'],
    situation_trigger: 'When child responds rudely/disrespectfully and you feel angry',
    location_type: ['home', 'anytime'],
    time_optimal: ['anytime'],
    intensity_level: 'moderate',
    success_speed: '30sec',
    parent_state: ['angry', 'feeling disrespected', 'hurt'],
    age_min: 5,
    age_max: 16,
    backup_plan: 'If they continue: "I don\'t talk to people who speak to me that way. Let me know when you\'re ready to try again." Walk away. End conversation. No audience = no power.',
    common_mistakes: ['Forcing apology (insincere + increases resentment)', 'Matching their disrespect (models what we don\'t want)', 'Long lectures about respect (they tune out)', 'Punishment that doesn\'t teach (doesn\'t build skill)'],
    pause_after_phrase_1: 3,
    pause_after_phrase_2: 2,
    expected_time_seconds: 30,
    requires_preparation: false,
    works_in_public: true,
    emergency_suitable: true
  },
  {
    title: 'Sibling Control Struggle',
    category: 'Social',
    wrong_way: '"Stop bossing your brother around! Let him play how he wants!"',
    phrase_1: 'You\'re in charge of your game, not his...',
    phrase_1_action: 'Separate if needed. State the boundary clearly.',
    phrase_2: 'Hard when you have ideas AND he gets his own choices...',
    phrase_2_action: 'Validate desire for control, maintain sibling autonomy.',
    phrase_3: 'Play together his way or play alone your way. Pick.',
    phrase_3_action: 'Give clear choice. Consequence = natural (separation). Let them choose.',
    neurological_tip: 'DEFIANT kids try to control others when feeling out of control themselves. Clear choice + natural consequence (separation) = they learn boundaries. Forced sharing doesn\'t teach - choice does.',
    profile: 'DEFIANT',
    tags: ['siblings', 'bossing', 'control', 'sharing', 'playing together', 'boundaries'],
    situation_trigger: 'When child is trying to control/boss sibling during play and conflict escalates',
    location_type: ['home', 'playroom'],
    time_optimal: ['anytime'],
    intensity_level: 'mild',
    success_speed: '1min',
    parent_state: ['frustrated', 'tired of refereeing', 'wanting peace'],
    age_min: 4,
    age_max: 12,
    backup_plan: 'If bossing continues: separate to different rooms/activities. Say: "You can try playing together again in 10 minutes." Separation = natural consequence of not cooperating.',
    common_mistakes: ['Forcing them to play together (breeds resentment)', 'Always blaming the defiant child (sibling may be triggering)', 'Making them apologize mid-conflict (insincere)', 'Removing toys as punishment (doesn\'t teach cooperation)'],
    pause_after_phrase_1: 3,
    pause_after_phrase_2: 2,
    expected_time_seconds: 60,
    requires_preparation: false,
    works_in_public: false,
    emergency_suitable: false
  },
  {
    title: 'Bedtime Argument Loop',
    category: 'Bedtime',
    wrong_way: '"I don\'t CARE if it\'s not fair! Bedtime is bedtime! END OF DISCUSSION!"',
    phrase_1: 'You think bedtime isn\'t fair tonight...',
    phrase_1_action: 'Acknowledge their position. Don\'t argue fairness yet.',
    phrase_2: 'You want more time AND bodies need sleep to grow...',
    phrase_2_action: 'Validate want, state biological reality.',
    phrase_3: 'Bed now or lose 10 minutes tomorrow. You choose what\'s fair.',
    phrase_3_action: 'Offer choice with consequence. Walk away. Don\'t debate.',
    neurological_tip: 'DEFIANT kids need sense of fairness/justice. Arguing fairness = engagement. "You choose" = transfers decision power. Tomorrow\'s consequence = immediate kids can understand fairness over time.',
    profile: 'DEFIANT',
    tags: ['bedtime', 'arguing', 'fairness', 'negotiation', 'power struggle', 'boundaries'],
    situation_trigger: 'When child argues bedtime isn\'t fair and you\'re stuck in debate loop',
    location_type: ['home', 'bedroom'],
    time_optimal: ['evening'],
    intensity_level: 'moderate',
    success_speed: '2min',
    parent_state: ['exhausted', 'wanting them in bed', 'frustrated with arguing'],
    age_min: 5,
    age_max: 14,
    backup_plan: 'After choice: "I\'m leaving in 2 minutes. Lights off or tomorrow starts 10 minutes earlier." Follow through tomorrow morning no matter what. Consistency = credibility.',
    common_mistakes: ['Debating fairness (no winner)', 'Giving in "just tonight" (teaches: arguing works)', 'Threatening but not following through (loss of trust)', 'Getting angry (gives them power)'],
    pause_after_phrase_1: 3,
    pause_after_phrase_2: 2,
    expected_time_seconds: 120,
    requires_preparation: false,
    works_in_public: false,
    emergency_suitable: false
  },
  {
    title: 'Car Seat Standoff',
    category: 'Transitions',
    wrong_way: '"Get in that car seat RIGHT NOW! You WILL obey me!"',
    phrase_1: 'Car seat time, you don\'t want to...',
    phrase_1_action: 'State fact. Open car door. Stand and wait.',
    phrase_2: 'I get it, it feels bossy, AND car seats are the law...',
    phrase_2_action: 'Acknowledge feeling, state non-negotiable reality.',
    phrase_3: 'Get in yourself or I put you in. Counting to 10.',
    phrase_3_action: 'Count slowly. At 10: calmly lift and buckle. No anger.',
    neurological_tip: 'DEFIANT kids fight control. "You don\'t want to" = acknowledges feeling. "The law" = removes you as the bad guy. Calm follow-through at 10 = you\'re not in a power struggle, just enforcing reality.',
    profile: 'DEFIANT',
    tags: ['car seat', 'cooperation', 'power struggle', 'safety', 'transitions', 'strong-willed'],
    situation_trigger: 'When child refuses car seat and says "you can\'t make me"',
    location_type: ['car', 'parking lot', 'public'],
    time_optimal: ['anytime'],
    intensity_level: 'moderate',
    success_speed: '45sec',
    parent_state: ['rushed', 'angry', 'embarrassed in public'],
    age_min: 3,
    age_max: 7,
    backup_plan: 'After buckling: "I know you didn\'t like that. Car seats keep kids alive. Not negotiable." Then drive. Don\'t engage further argument. Safety > their approval.',
    common_mistakes: ['Engaging "you can\'t make me" debate (wastes time)', 'Bribing to get in (teaches: refusal = rewards)', 'Yelling while forcing (scary + ineffective)', 'Giving up and not going (teaches: refusal works)'],
    pause_after_phrase_1: 3,
    pause_after_phrase_2: 2,
    expected_time_seconds: 45,
    requires_preparation: false,
    works_in_public: true,
    emergency_suitable: true
  },
  {
    title: 'Homework Standoff',
    category: 'Homework',
    wrong_way: '"You WILL do your homework! Sit there until it\'s done, I don\'t care if it takes all night!"',
    phrase_1: 'Homework time, you\'re refusing...',
    phrase_1_action: 'State what\'s happening. No judgment. Sit nearby.',
    phrase_2: 'You don\'t want to do it, AND it\'s yours to do...',
    phrase_2_action: 'Acknowledge resistance, place responsibility with them.',
    phrase_3: 'Done by 7pm or explain to teacher tomorrow. Your choice, your grade.',
    phrase_3_action: 'Set deadline. Walk away. Natural consequence = grade, not your anger.',
    neurological_tip: 'DEFIANT kids resist forced academics. Making it their problem (grade/teacher) removes power struggle with you. Natural consequence > punishment. Some kids need to fail once to learn.',
    profile: 'DEFIANT',
    tags: ['homework', 'refusal', 'power struggle', 'school', 'responsibility', 'consequences'],
    situation_trigger: 'When child flat-out refuses to do homework and you\'re tempted to force it',
    location_type: ['home'],
    time_optimal: ['afternoon', 'evening'],
    intensity_level: 'severe',
    success_speed: '2min',
    parent_state: ['frustrated', 'worried about grades', 'angry'],
    age_min: 7,
    age_max: 16,
    backup_plan: 'If not done by 7pm: "Okay, you chose not to do it. You\'ll explain to teacher. I\'ll email so they know." Let them face consequence at school. Don\'t rescue.',
    common_mistakes: ['Forcing them to sit there (breeds resentment)', 'Doing homework for them (removes learning)', 'Extreme punishments (doesn\'t motivate)', 'Fighting about it (makes it about you, not their learning)'],
    pause_after_phrase_1: 3,
    pause_after_phrase_2: 2,
    expected_time_seconds: 120,
    requires_preparation: false,
    works_in_public: false,
    emergency_suitable: false
  },
  {
    title: 'Mealtime Demands',
    category: 'Mealtime',
    wrong_way: '"This is what we\'re eating! I\'m not making you something different!"',
    phrase_1: 'You want different food tonight...',
    phrase_1_action: 'Acknowledge request. Don\'t say yes or no yet.',
    phrase_2: 'You\'d like your choice AND I made this meal...',
    phrase_2_action: 'Validate preference, state reality.',
    phrase_3: 'Eat this or make yourself toast. Kitchen closes at 7.',
    phrase_3_action: 'Offer simple alternative they can make. Set boundary. Walk away.',
    neurological_tip: 'DEFIANT kids need autonomy in choices. "Make yourself toast" = gives control + teaches self-sufficiency. Not caving (no special meal) + not forcing (toast option) = balanced boundary.',
    profile: 'DEFIANT',
    tags: ['mealtime', 'picky eating', 'demands', 'power struggle', 'food', 'cooking'],
    situation_trigger: 'When child demands different meal than what was made and refuses to eat',
    location_type: ['home'],
    time_optimal: ['evening', 'anytime'],
    intensity_level: 'moderate',
    success_speed: '1min',
    parent_state: ['frustrated', 'tired of cooking', 'feeling unappreciated'],
    age_min: 5,
    age_max: 14,
    backup_plan: 'If they don\'t eat: "Okay, you chose not to eat. Kitchen closes at 7. Breakfast is at 7am." Let them be hungry. They won\'t starve overnight. Natural consequence.',
    common_mistakes: ['Making separate meal (teaches: demanding works)', 'Forcing them to eat yours (creates food battles)', 'Offering unlimited snacks later (no consequence)', 'Getting offended they don\'t like it (not personal)'],
    pause_after_phrase_1: 3,
    pause_after_phrase_2: 2,
    expected_time_seconds: 60,
    requires_preparation: false,
    works_in_public: false,
    emergency_suitable: false
  },
  {
    title: 'Public "NO" With Audience',
    category: 'Tantrums',
    wrong_way: '"Everyone is watching! You are embarrassing me! Stop acting like this RIGHT NOW!"',
    phrase_1: 'Big NO in public, I hear you...',
    phrase_1_action: 'Acknowledge. Block your bodies from onlookers. Lower voice.',
    phrase_2: 'You want people to see you\'re in charge, AND we\'re leaving...',
    phrase_2_action: 'Name the power move. State boundary. Ignore audience.',
    phrase_3: 'Walk or I carry. Starting to count. 5... 4...',
    phrase_3_action: 'Count down. At 0: pick up calmly. Walk out. No shame, just consequence.',
    neurological_tip: 'DEFIANT kids escalate with audience - audience = power. Removing audience (leaving) removes their leverage. Calm carry = you\'re not in power struggle. Ignoring public shame = models self-respect.',
    profile: 'DEFIANT',
    tags: ['public tantrum', 'power struggle', 'defiance', 'shopping', 'embarrassment', 'strong-willed'],
    situation_trigger: 'When child says NO loudly in public/store and seems to enjoy your embarrassment',
    location_type: ['public', 'store', 'restaurant'],
    time_optimal: ['anytime'],
    intensity_level: 'severe',
    success_speed: '30sec',
    parent_state: ['embarrassed', 'angry', 'wanting to disappear'],
    age_min: 3,
    age_max: 10,
    backup_plan: 'Carry them out to car. Buckle in. Sit in driver seat. Don\'t leave yet. Say nothing. Wait for calm. Then: "That behavior ends trips early. We\'ll try again another day." Drive home.',
    common_mistakes: ['Giving in to avoid scene (teaches: public = works)', 'Yelling/threatening (gives them more audience power)', 'Apologizing to strangers (teaches: their opinion matters more)', 'Dragging it out (quick exit removes power source)'],
    pause_after_phrase_1: 3,
    pause_after_phrase_2: 2,
    expected_time_seconds: 30,
    requires_preparation: false,
    works_in_public: true,
    emergency_suitable: true
  }
];

async function insertAllScripts() {
  console.log('üöÄ Inserindo 20 scripts (10 DISTRACTED + 10 DEFIANT)...\n');

  let successCount = 0;
  let errorCount = 0;
  const allScripts = [...distractedScripts, ...defiantScripts];

  for (let i = 0; i < allScripts.length; i++) {
    const script = allScripts[i];
    const profile = script.profile;
    const num = profile === 'DISTRACTED' ? i + 1 : i - 9;
    console.log(`[${i+1}/20] ${profile} #${num}: ${script.title}`);

    const { data, error } = await supabase
      .from('scripts')
      .insert([script])
      .select();

    if (error) {
      console.log(`   ‚ùå Erro: ${error.message}`);
      errorCount++;
    } else {
      console.log(`   ‚úÖ Inserido!`);
      successCount++;
    }
  }

  console.log('\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');
  console.log('üìä RESULTADO:');
  console.log(`   ‚úÖ Sucesso: ${successCount} scripts`);
  console.log(`   ‚ùå Erros: ${errorCount} scripts`);
  console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n');

  // Verificar totais finais
  console.log('üìã TOTAIS NO BANCO:\n');
  const { data: stats, error: statsError } = await supabase
    .from('scripts')
    .select('profile')
    .in('profile', ['INTENSE', 'DISTRACTED', 'DEFIANT']);

  if (!statsError && stats) {
    const counts = {
      INTENSE: stats.filter(s => s.profile === 'INTENSE').length,
      DISTRACTED: stats.filter(s => s.profile === 'DISTRACTED').length,
      DEFIANT: stats.filter(s => s.profile === 'DEFIANT').length
    };

    console.log(`   INTENSE: ${counts.INTENSE} scripts`);
    console.log(`   DISTRACTED: ${counts.DISTRACTED} scripts`);
    console.log(`   DEFIANT: ${counts.DEFIANT} scripts`);
    console.log(`   TOTAL: ${counts.INTENSE + counts.DISTRACTED + counts.DEFIANT} scripts\n`);
  }

  console.log('‚úÖ CONCLU√çDO! Todos os 30 scripts NEP est√£o no banco!\n');
}

insertAllScripts();
